{"version":3,"file":"index.es.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { Component, createRef } from \"react\";\r\n\r\n// Import JQuery, required for the functioning of the equation editor\r\nimport $ from \"jquery\";\r\n\r\n// Import the styles from the Mathquill editor\r\nimport \"mathquill/build/mathquill.css\";\r\n\r\n// eslint-disable-next-line @typescript-eslint/ban-ts-ignore\r\n// @ts-ignore\r\nwindow.jQuery = $;\r\n\r\n// eslint-disable-next-line @typescript-eslint/ban-ts-ignore\r\n// @ts-ignore\r\nrequire(\"mathquill/build/mathquill\");\r\n\r\n// eslint-disable-next-line @typescript-eslint/ban-ts-ignore\r\n// @ts-ignore\r\n// eslint-disable-next-line no-undef\r\nconst mathQuill = MathQuill.getInterface(2);\r\n\r\ntype EquationEditorProps = {\r\n  onChange(latex: string): void;\r\n  value: string;\r\n  spaceBehavesLikeTab: boolean;\r\n  autoCommands: string;\r\n  autoOperatorNames: string;\r\n};\r\n\r\n/**\r\n * @typedef {EquationEditorProps} props\r\n * @prop {Function} onChange Triggered when content of the equation editor changes\r\n * @prop {string} value Content of the equation handler\r\n * @prop {boolean} spaceBehavesLikeTab Whether spacebar should simulate tab behavior\r\n * @prop {string} autoCommands List of commands for which you only have to type the name of the\r\n * command with a \\ in front of it. Examples: pi theta rho sum\r\n * @prop {string} autoOperatorNames List of operators for which you only have to type the name of the\r\n * operator with a \\ in front of it. Examples: sin cos tan\r\n * @extends {Component<EquationEditorProps>}\r\n */\r\nclass EquationEditor extends Component<EquationEditorProps> {\r\n  element: any;\r\n  mathField: any;\r\n  ignoreEditEvents: number;\r\n\r\n  // Element needs to be in the class format and thus requires a constructor. The steps that are run\r\n  // in the constructor is to make sure that React can succesfully communicate with the equation\r\n  // editor.\r\n  constructor(props: EquationEditorProps) {\r\n    super(props);\r\n\r\n    this.element = createRef();\r\n    this.mathField = null;\r\n\r\n    // MathJax apparently fire 2 edit events on startup.\r\n    this.ignoreEditEvents = 2;\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { onChange, value,spaceBehavesLikeTab, autoCommands, autoOperatorNames } = this.props;\r\n\r\n    const config = {\r\n      handlers: {\r\n        edit: () => {\r\n          if (this.ignoreEditEvents > 0) {\r\n            this.ignoreEditEvents -= 1;\r\n            return;\r\n          }\r\n          if (this.mathField.latex() !== value) {\r\n            onChange(this.mathField.latex());\r\n          }\r\n        },\r\n      },\r\n      spaceBehavesLikeTab,\r\n      autoCommands,\r\n      autoOperatorNames,\r\n    };\r\n\r\n    this.mathField = mathQuill.MathField(this.element.current, config);\r\n    this.mathField.latex(value || \"\");\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <span ref={this.element} style={{ border: \"0px\", boxShadow: \"None\" }} />\r\n    );\r\n  }\r\n}\r\n\r\nexport default EquationEditor;\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA;AACA;AACA,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;AAElB;AACA;AACA,OAAO,CAAC,2BAA2B,CAAC,CAAC;AAErC;AACA;AACA;AACA,IAAM,SAAS,GAAG,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;AAU5C;;;;;;;;;;;;IAW6B,kCAA8B;;;;IAQzD,wBAAY,KAA0B;QAAtC,YACE,kBAAM,KAAK,CAAC,SAOb;QALC,KAAI,CAAC,OAAO,GAAG,SAAS,EAAE,CAAC;QAC3B,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC;;QAGtB,KAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;;KAC3B;IAED,0CAAiB,GAAjB;QAAA,iBAsBC;QArBO,IAAA,KAA2E,IAAI,CAAC,KAAK,EAAnF,QAAQ,cAAA,EAAE,KAAK,WAAA,EAAC,mBAAmB,yBAAA,EAAE,YAAY,kBAAA,EAAE,iBAAiB,uBAAe,CAAC;QAE5F,IAAM,MAAM,GAAG;YACb,QAAQ,EAAE;gBACR,IAAI,EAAE;oBACJ,IAAI,KAAI,CAAC,gBAAgB,GAAG,CAAC,EAAE;wBAC7B,KAAI,CAAC,gBAAgB,IAAI,CAAC,CAAC;wBAC3B,OAAO;qBACR;oBACD,IAAI,KAAI,CAAC,SAAS,CAAC,KAAK,EAAE,KAAK,KAAK,EAAE;wBACpC,QAAQ,CAAC,KAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;qBAClC;iBACF;aACF;YACD,mBAAmB,qBAAA;YACnB,YAAY,cAAA;YACZ,iBAAiB,mBAAA;SAClB,CAAC;QAEF,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;QACnE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC;KACnC;IAED,+BAAM,GAAN;QACE,QACE,8BAAM,GAAG,EAAE,IAAI,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,EAAE,GAAI,EACxE;KACH;IACH,qBAAC;AAAD,CA/CA,CAA6B,SAAS;;;;"}